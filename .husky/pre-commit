#!/bin/sh

# Function to handle errors
handle_error() {
  echo "Error: $1 failed"
  echo "Please fix the issues before committing"
  exit 1
}

echo "Running pre-commit checks..."

# Run linting first
echo "Running lint..."
pnpm run -r lint || handle_error "Lint"

# Run tests with --passWithNoTests to handle packages without tests
echo "Running tests..."
pnpm run -r test -- --passWithNoTests || handle_error "Tests"

# Run builds if tests pass
echo "Running builds..."
pnpm run -r build --if-present || handle_error "Build"

echo "âœ¨ All checks passed! Proceeding with commit..."